import{d as U,D as b,a as z,l as t,w as n,F as O,b as d,o as Z,x as p,S,T as g}from"./index-WWavzJPV.js";import{v as K,P,T as F,a as N,C as M,V as R,b as B,c as C,s as k}from"./VStepper-CD5EFS6a.js";import{a as D,V as y}from"./index-BHrNHZeN.js";import{V as E,a as V,b as I,c as j}from"./VCard-C7iD426i.js";import"./index-CfstKSwk.js";function L(){return K()}function x(f){const[u,T,m]=f.split(":").map(Number),r=new Date;return r.setUTCHours(u),r.setUTCMinutes(T),r.setUTCSeconds(m),r}function J(f){const u=new P,T=new Map,m=new Map;Object.keys(f).forEach(a=>{f[a].forEach(o=>{const c=L();T.set(o.Subject,c),u.Subjects.set(c,{Name:o.Subject,Initial:o.Subject.substring(0,1),TeacherName:"",IsOutDoor:!1})})});const r=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return r.forEach(a=>{const i=f[a];if(!i||i.length===0)return;const o=L();m.set(a,o);const c=new F;c.Name=a,i.forEach((s,e)=>{const l=new N,w=x(s.StartTime),v=x(s.EndTime);if(l.StartSecond=w,l.EndSecond=v,l.TimeType=0,c.Layouts.push(l),e<i.length-1){const _=x(i[e+1].StartTime),h=new N;h.StartSecond=v,h.EndSecond=_,h.TimeType=1,c.Layouts.push(h)}}),u.TimeLayouts.set(o,c)}),r.forEach((a,i)=>{const o=new M,c=f[a],s=m.get(a);s!=null&&(o.Name=a,o.TimeRule.WeekDay=(i+1)%7===0?0:(i+1)%7,o.TimeLayoutId=s,c.forEach(e=>{const l=T.get(e.Subject);o.Classes.push({SubjectId:l??""})}),u.ClassPlans.set(L(),o))}),u}function W(f){return JSON.parse(f)}const $=d("h1",{class:"text-h3 text-sm-h3"},"从ZongziTEK黑板贴迁移",-1),A=d("br",null,null,-1),G=d("br",null,null,-1),H=d("br",null,null,-1),q=d("br",null,null,-1),Q=d("br",null,null,-1),X=d("br",null,null,-1),Y=d("br",null,null,-1),ee=d("br",null,null,-1),te=d("br",null,null,-1),ue=U({__name:"zztek",setup(f){const u=b(null),T=b(""),m=b(!1),r=b(!1),a=b(null);function i(){if(m.value=!1,a.value=null,u.value){const s=new FileReader;s.onload=e=>{var l;T.value=(l=e.target)==null?void 0:l.result},s.readAsText(u.value)}r.value=!0}function o(s,e){const l=e instanceof Object?JSON.stringify(e,null,4):e,w=window.URL||window.webkitURL||window,v=new Blob([l]),_=document.createElement("a");_.href=w.createObjectURL(v),_.download=s,_.click()}function c(){try{const s=W(T.value),e=J(s);console.log(e),m.value=!0;const l=URL.createObjectURL(new Blob([k(e)],{type:"application/json"}));console.log("下载链接：",l),o("ProfileZZTEK.json",k(e))}catch(s){a.value=s,m.value=!1}}return(s,e)=>(Z(),z(O,null,[$,A,t(R,{items:["说明","上传黑板贴配置","转换"]},{"item.1":n(()=>[t(E,{flat:""},{default:n(()=>[t(V,null,{default:n(()=>[t(I,null,{default:n(()=>[p("转换说明")]),_:1})]),_:1}),t(j,null,{default:n(()=>[p(" 本转换向导将提供将ZongziTEK黑板贴带有时间信息的课程表 转换为ClassIsland档案文件的服务。 "),G,p(" 上传您的ZongziTEK黑板贴带时间课表文件 (JSON)，然后点击开始转换。 "),H,p(" 转换完成后，ClassIsland档案文件将会自动下载，您可以将其导入到ClassIsland中 (直接放入Profiles文件夹)。 ")]),_:1})]),_:1})]),"item.2":n(()=>[t(E,{flat:""},{default:n(()=>[t(V,null,{default:n(()=>[t(I,null,{default:n(()=>[p("上传黑板贴课程表")]),_:1})]),_:1}),t(j,null,{default:n(()=>[p(" 请上传您的ZongziTEK黑板贴带时间课表文件 (Timetable.json)。它通常位于ZongziTEK黑板贴的根目录。 "),q,Q,t(B,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l),accept:"application/json",label:"上传配置文件",onMultiple:l=>!1,onChange:e[1]||(e[1]=l=>i())},null,8,["modelValue"])]),_:1})]),_:1})]),"item.3":n(()=>[t(E,{flat:""},{default:n(()=>[t(V,null,{default:n(()=>[t(I,null,{default:n(()=>[p("转换")]),_:1})]),_:1}),t(j,null,{default:n(()=>[p(" 确认上传文件无误后，请点击“开始转换”。 "),X,Y,S(t(D,{onClick:e[2]||(e[2]=l=>c())},{default:n(()=>[p("开始转换")]),_:1},512),[[g,r.value]]),ee,te,t(y,null,{default:n(()=>[S(t(C,{title:"转换完成",text:"ClassIsland档案文件将会自动下载，您可以将其导入到ClassIsland中(直接放入Profiles文件夹)。",type:"success"},null,512),[[g,m.value]])]),_:1}),t(y,null,{default:n(()=>[S(t(C,{title:"请先上传文件",text:"请先上传您的黑板贴带时间课表文件 (Timetable.json)。",type:"warning"},null,512),[[g,!r.value]])]),_:1}),t(y,null,{default:n(()=>[S(t(C,{title:"转换失败",text:"转换过程中发生错误，请检查您的配置文件。"+a.value,type:"error"},null,8,["text"]),[[g,a.value]])]),_:1})]),_:1})]),_:1})]),_:1})],64))}});export{ue as default};
